{% extends "content_wrapper_with_sidebar.html" %}


{% block inner_content %}
<div class="container min-height-content col-sm-11" id="content-wrapper">

	<!-- Title content--> 
	{% if messages %}
	<ul class="messages">
		{% for message in messages %}
		<li{% if message.tags %} class="{{ message.tags }}"{% endif %}>
		{% if message.level == DEFAULT_MESSAGE_LEVELS.ERROR %}Important: {% endif %}
		{{ message }}
	</li>
	{% endfor %}
	</ul>
	{% endif %}
	{% include "toggle_title.html" %}
	<!-- EndTitle content-->

	{% for autor_trabajo in autores_trabajos_list %} 
		<!-- First Row New-->
		<div class="row">
			<div class="col-sm-12">
				<div class="jumbotron RLcard">
					<div class="row">
						<h2 class="text-left">Autor</h2>
					</div>

					<div class="row middle-content">
						<div class="col-sm-10">
							<h3>Datos de pagadores del trabajo: '{{ autor_trabajo.trabajo.titulo_espanol }}'</h3>
						</div>
						{% if  autor_trabajo.monto_total > 0 and autor_trabajo.es_autor_principal%}
							<div class="col-sm-3 text-center">
								<button  class="btn btn-primary btn-lg btn-block añadir-pago-form" data-url ="{% url 'autores:postular_trabajo_pagador_modal' autor_trabajo.id %}" >Añadir Pago</button>
							</div>
						{% elif autor_trabajo.monto_total == 0 %}
						<div class="col-sm-2 text-center">
							<a href="#" class="btn btn-lg btn-success btn-block" >Pagado</a>
						</div>
						{% endif %}
					</div>

					<br>
					<table class="table table-bordered show-pays">
						<thead>
							<tr>
								<th class="col-sm-3">Nombre</th>
								<th class="col-sm-2">Cédula</th>                 
								<th class="col-sm-2">Banco Origen</th>
								<th class="col-sm-2">N° de Transferencia/Cheque</th>
								<th class="col-sm-2">Monto pagado</th>
								<th class="col-sm-1">Acciones</th>
							</tr>
						</thead>
						<tbody>
							{% for pagador in pagador_list %}
							<tr>
								{% if pagador.autor_trabajo == autor_trabajo%}
								<td>{{ pagador.datos_pagador.nombres }} {{ pagador.datos_pagador.apellidos}}</td>
								<td>{{ pagador.datos_pagador.cedula }}</td>

								{% for factura in factura_list %}
								{% if factura.pagador == pagador %}
								<td>{{ factura.pago.banco_origen }}</td>
								<td>
									{% if factura.pago.numero_transferencia %}
										{{ factura.pago.numero_transferencia }}
									{% else %}
										{{ factura.pago.numero_cheque }}
									{% endif %}
								</td>
								<td>{{ factura.monto_total}}</td>
								{% endif %}
								{% endfor %}
								<td>
									<a href="{% url 'autores:detalles_pago' pagador.id %}" class="btn btn-info" role="button" data-toggle="tooltip" data-placement="top" title="Información Completa">
										<i class="fas fa-door-open"></i>
									</a>
								</td>
								{% endif %}
							</tr> 
							{% endfor %}                
						</tbody>
					</table>
					<!-- End table  -->

				</div>
			</div>
		</div>
		<!-- EndFirst Row New-->
	{% endfor %}
</div>


<!-- modal -->
<div class="modal fade" id="modal-pay">
	<div class="modal-dialog">
		<div class="modal-content">
			
		</div>
	</div>
</div>

{% endblock %}
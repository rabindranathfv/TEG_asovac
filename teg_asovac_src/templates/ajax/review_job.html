{% load crispy_forms_tags %}
<form method="post" action="{% url 'arbitrajes:review_job' trabajo.id %}">
    {% csrf_token %}

    <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
        </button>
        <h4 class="modal-title" >Arbitrar trabajo</h4>
    </div>
    <div class="modal-body text-center">
        <strong>Título:</strong> <p>{{ trabajo.titulo_espanol }} </p>
        <strong>Área:</strong> <p> {{ trabajo.subareas.first.area }} </p>
        <strong>Subárea:</strong> <p> {{ trabajo.subareas.first }}</p>
        <strong>Resumen:</strong> <p>  {{trabajo.resumen}}</p>
        {% if trabajo.url_trabajo %}
            <strong>URL del trabajo:</strong> <p> {{ trabajo.url_trabajo }} </p>
        {% endif %}
        <strong>Forma de Presentación:</strong> <p>{{ trabajo.get_forma_presentacion_display }}</p>
        <div class="preview-pdf">
            <object data="{{ trabajo.archivo_trabajo.url }}" type="application/pdf" width="100%" height="600px">
                <iframe src="{{trabajo.archivo_trabajo.url }}" width="100%" height="100%" style="border: none;">
                Este navegador no soporta PDFs. Por favor descarga el PDF para verlo:<a href="{{trabajo.archivo_trabajo.url}}">Descargar PDF</a>
                </iframe>
            </object>
        </div>
    </div>
    <div class="modal-footer">
        <p class="text-center btn-danger" >Una vez le dé click en arbitrar, no podrá cambiar su decisión.</p>
        <div class="col-md-12">
            <br>
            <select name="status" id="status" class=" form-control" required>
                <option selected value="">Seleccione el resultado</option>
                <option value="Aceptado">Aceptado</option>
                <option value="Rechazado">Rechazado</option>
            </select>
            <br>
        </div>
        <div class="col-md-12">
            <textarea name="comment" id="comment" rows="4" class="form-control" onkeyup="check(this);" style="display:none;"></textarea>
        </div>
        <br>
        <button type="button" class="btn btn-danger" data-dismiss="modal">Cancelar</button>
        <button disabled="true" type="submit" class="sendGenericForm btn btn-success">Arbitrar</button>
    </div>
</form>

<script>
    $("#status").change(function (e) { 
        var status= $(this).val();
        console.log("El estatus es: "+status);
        if (status == "Rechazado") {
            $("#comment").show();
            $(".sendGenericForm").prop('disabled', true);
            console.log("El estatus es rechazado");
        }else{
            if (status == "Aceptado") {
                console.log("El estatus es aceptado");
                $(".sendGenericForm").prop('disabled', false);
                $("#comment").hide();
            }else{
                console.log("El estatus es pendiente");
                $("#comment").hide();
                $(".sendGenericForm").prop('disabled', false);
            }
        }
        
    });
    function check(element) {
        console.log(element.value)
        if(element.value.trim() != ""){
            $(".sendGenericForm").prop('disabled', false);
        }else{
            $(".sendGenericForm").prop('disabled', true);
        }
    };
   
</script>
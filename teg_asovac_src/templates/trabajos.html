{% extends "base.html" %}

{% load crispy_forms_tags %}

{% block content %}
<!-- Fixed Sidebar & Content-->
<div id="wrapper" class="toggled">

        {% include 'sidebar.html'%}
   
        <!-- Page Content -->
        <div class="container login-content col-sm-11" id="content-wrapper">
            <!-- Title content--> 
            <div class="row">
                <div>
                    <a href="#menu-toggle" class="btn btn-primary" id="menu-toggle">
                        <i class="fas fa-angle-double-left" id="menu-toggle-icon"></i>
                    </a>
                    <h3 class="user-title">Trabajos</h3>
                </div>
            </div>
             <!-- EndTitle content-->

             <!-- First Row -->
             <div class="row">
               <div class="col-sm-12">
                   <div class="jumbotron RLcard">
                    <div class="col-sm-6">
                        <h2 class="text-left">Autor - Lista de trabajos</h2>
                    </div>

                    <br>
                           <table class="table table-bordered">
                               <thead>
                                 <tr>
                                    <th class="col-sm-2">T&iacute;tulo</th>
                                    <th class="col-sm-2">&Aacute;rea</th>
                                    <th class="col-sm-2">Subárea</th>
                                    <th class="col-sm-2">Autor(es)</th>
                                    <th class="col-sm-1">Estatus</th>
                                    <th class="col-sm-1">Versi&oacute;n</th>
                                    <th class="col-sm-2">Acciones</th>
                                 </tr>
                               </thead>
                               <tbody>
                                  {% for trabajo in trabajos %}
                                   <tr>
                                      <td>{{ trabajo.trabajo.titulo_espanol }}</td>
                                      <td>{{ trabajo.trabajo.area }}</td>
                                      <td>{{ trabajo.trabajo.subarea1 }}</td>
                                      <td>
                                          {{ trabajo.autor.nombres }} {{ trabajo.autor.apellidos }}
                                      </td>
                                      <td>
                                        {% if trabajo.trabajo.estatus == "Pendiente" %}
                                          <span class="label label-warning lb-md center-block">Pendiente</span>
                                        {% elif trabajo.trabajo.estatus == "Aprobado" %}
                                          <span class="label label-success lb-md center-block">Aprobado</span>
                                        {% elif trabajo.trabajo.estatus == "Rechazado" %}
                                          <span class="label label-danger lb-md center-block">Rechazado</span>
                                        {% endif %}
                                      </td>
                                      <td class="col-sm-1">2.0</td>
                                      <td class="col-sm-1 text-center">
                                          
                                      {% if trabajo.monto_total != 0 %}<!-- Esto es para corroborar que el trabajo no ha sido postulado -->
                                          <a href="{% url 'trabajos:edit_trabajo' %}" class="btn btn-info" role="button" data-toggle="tooltip" data-placement="top" title="Editar">
                                              <i class="fas fa-edit"></i>
                                          </a>
                                          <a href="#" class="btn btn-info" role="button" data-toggle="modal" data-target="#ModalDelete" title="Borrar">
                                              <i class="fas fa-times"></i>
                                          </a>
                                      {% endif %}
                                          <a href="" class="btn btn-info" role="button" title="Ver trabajo">
                                              <i class="fas fa-door-open"></i>
                                          </a>
                                      </td>
                                   </tr>
                                   {% endfor %}              
                               </tbody>
                             </table>
                           <!-- End table  -->
                          <div class="pagination">
                            <span class="step-links">
                                {% if trabajos.has_previous %}
                                    <a href="?page={{ trabajos.previous_page_number }}">previous</a>
                                {% endif %}

                                <span class="current">
                                    Page {{ trabajos.number }} of {{ trabajos.paginator.num_pages }}.
                                </span>

                                {% if trabajos.has_next %}
                                    <a href="?page={{ trabajos.next_page_number }}">next</a>
                                {% endif %}
                            </span>
                          </div>



                        <div class="panel panel-default">
                            <div class="panel-heading">
                                <a href="#accordion" class="btn btn-info btn-block" data-toggle="collapse">Crear Trabajo</a>
                            </div>
                            <div id="accordion" class="panel-body collapse">
                                <div class="container-fluid">
                                    <div class="row middle-content">
                                        <div class="col-sm-12">
                                            {% crispy form %}
                                            <!--
                                            <div class="col-sm-2 col-sm-offset-8">
                                                <a href="#accordion" class="btn btn-danger btn-block btn-lg" data-toggle="collapse">Cancelar</a>
                                            </div>
                                            <div class="col-sm-2">
                                                <button type="button" class="btn btn-primary btn-success btn-lg btn-block" data-toggle="modal" data-target="#ModalCenter">Guardar</button>
                                            </div>
                                            -->
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
               </div>
             </div>
             <!-- EndFirst Row -->
   
        </div>
</div>

<!-- Modal Crear Trabajo-->
<div class="modal fade" id="ModalCenter" tabindex="-1" role="dialog" aria-labelledby="ModalCenterTitle" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title" id="ModalLongTitle">Crear Trabajo</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body text-center content-modal">
        ¿Está seguro que desea crear el trabajo?
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary btn-danger" data-dismiss="modal">Cancelar</button>
        <button type="submit" class="btn btn-primary btn-success">Crear</button>
      </div>
    </div>
  </div>
</div>

<!-- Modal Eliminar Trabajo-->
<div class="modal fade" id="ModalDelete" tabindex="-1" role="dialog" aria-labelledby="ModalCenterTitle" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title" id="ModalLongTitle">Eliminar Trabajo</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body text-center content-modal">
        ¿Está seguro que desea ELIMINAR el trabajo?
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary btn-danger" data-dismiss="modal">Cancelar</button>
        <button type="submit" class="btn btn-primary btn-success">Eliminar</button>
      </div>
    </div>
  </div>
</div>

{% endblock %}